OASISFormat:  0.3
Name:         mlvm
Version:      0.1
Synopsis:     Pure OCaml volume manager, compatible with Linux LVM
License:      LGPL-2.1 with OCaml linking exception
Authors:      various
Copyrights:   (C) 2012 Citrix
BuildTools:   ocamlbuild
Plugins:      DevFiles (0.3), META (0.3)

Flag mapper
  Description: build the device-mapper interface
  Default: false

Library lvm
  Path: lib
  Modules: Result, S, Monad, Absty, Allocator, Constants, Label, Metadata, Crc, IO, Logging, Lvmconfiglex, Lvmconfigparser, Lv, Uuid, Pv, Redo, Tag, Utils, Vg 
  Findlibname: lvm
  Pack: true
  BuildDepends: sexplib.syntax,sexplib,uuidm,re.str,cstruct,mirage-types,lwt

Library lvm_mirage
  Path: mirage
  Modules: Disk_mirage
  Findlibname: mirage
  Findlibparent: lvm
  BuildDepends: lvm, mirage-types.lwt

Library lvm_dummy
  Path: dummy
  Modules: Disk_dummy
  Findlibname: dummy
  Findlibparent: lvm
  BuildDepends: lvm, mirage-block-unix

Library lvm_mapper
  Build$: flag(mapper)
  Install$: flag(mapper)
  Path: mapper
  Modules: Mapper
  Findlibname: mapper
  Findlibparent: lvm

Executable mlvm
  CompiledObject:     best
  Path:               src
  MainIs:             main.ml
  Custom:             true
  Install:            false
  BuildDepends:       lvm, lvm.mirage, lvm.dummy, cmdliner, io-page.unix, io-page, mirage-block-unix

Executable tag_test
  CompiledObject:     best
  Path:               lib_test
  MainIs:             tag_test.ml
  Custom:             true
  Install:            false
  BuildDepends:       lvm, oUnit

Test tag_test
  Command:            ./tag_test.native
  Run:                true

Executable vg_test
  CompiledObject:     best
  Path:               lib_test
  MainIs:             vg_test.ml
  Custom:             true
  Install:            false
  BuildDepends:       lvm, lvm.mirage, lvm.dummy, oUnit, io-page.unix, io-page, mirage-block-unix

Test vg_test
  Command:            ./vg_test.native
  Run:                true

Executable allocator_test
  CompiledObject:     best
  Path:               lib_test
  MainIs:             allocator_test.ml
  Custom:             true
  Install:            false
  BuildDepends:       lvm, kaputt

Test allocator_test
  Command:            ./allocator_test.native
  Run:                true
